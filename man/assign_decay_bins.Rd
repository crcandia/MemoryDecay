% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{assign_decay_bins}
\alias{assign_decay_bins}
\title{Assign Decay Bins to Cumulative Attention Values (Log-Scaled)}
\usage{
assign_decay_bins(
  cumulative_df,
  breaks = NULL,
  n_bins = 3,
  return_labels = TRUE
)
}
\arguments{
\item{cumulative_df}{A data frame of cumulative values (from \code{\link{compute_cumulative_matrix}}).}

\item{breaks}{Optional numeric vector of manual breakpoints (strictly increasing).
If provided, \code{n_bins} is ignored.}

\item{n_bins}{Integer. Number of log-spaced bins to compute automatically (default: 3).}

\item{return_labels}{Logical. If \code{TRUE}, returns bins as factor labels (1 = highest);
if \code{FALSE}, returns numeric bin index.}
}
\value{
A data frame with the same shape as \code{cumulative_df}, containing bin assignments.
        Zero-valued entries are returned as \code{NA}.
}
\description{
Assigns each cumulative attention value (e.g., cumulative citations) to a discrete bin
for stratified modeling of memory decay. Bins can be defined either:
- Manually using custom breakpoints (`breaks`), or
- Automatically using log-scaled quantization (`n_bins`).
}
\details{
The input should be a wide-format matrix of cumulative values over time, typically produced
by \code{\link{compute_cumulative_matrix}}. Columns represent items (e.g., papers),
and rows represent time steps.

## Treatment of Zeros

Items with \strong{zero cumulative attention} are excluded from bin breakpoint computation:
- Log-scale binning is undefined at zero (\code{log10(0)} = \code{-Inf}).
- Including zeros would skew binning and reduce stratification resolution.

In this function, **zero values are intentionally excluded** from the binning computation. 
This is because log-scale binning requires strictly positive values and because 
zero cumulative attention reflects complete forgetting — which is not comparable 
in magnitude to any non-zero value. Therefore, items with zero cumulative attention 
are assigned `NA` as their decay bin.
These zero entries are retained in the output but marked as \code{NA} to indicate that
they are unbinned. This allows separate modeling of completely forgotten items.

## Rationale: Controlling for Preferential Attachment

As described by Candia et al. (2019, \emph{Nature Human Behaviour}), binning items
by cumulative attention allows researchers to control for preferential attachment—
the tendency of popular items to accumulate even more attention.
This enables fair comparisons of memory decay across items with similar total attention.
}
\examples{
mat <- data.frame(A = c(0, 2, 10, 100), B = c(0, 1, 5, 50))
assign_decay_bins(mat, n_bins = 3)

}
\seealso{
\code{\link{merge_bins_with_original}}, \code{\link{reshape_citation_timeseries}}, \code{\link{process_time_series_bins}}
}
