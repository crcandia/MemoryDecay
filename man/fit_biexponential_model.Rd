% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_decay_models.R
\name{fit_biexponential_model}
\alias{fit_biexponential_model}
\alias{fit_biexponential_model_agg}
\title{Fit biexponential model to memory data (grouped or not)}
\usage{
fit_biexponential_model(
  data,
  age_var = "age",
  observed_col = "CurrentPopularity",
  group_var = NULL,
  group_var2 = NULL,
  N_ref = NULL,
  weight_early_points = FALSE
)
}
\arguments{
\item{data}{A data frame containing memory data.}

\item{age_var}{Name of the age column (default: "age").}

\item{observed_col}{Name of the observed popularity/attention column (default: "CurrentPopularity").}

\item{group_var}{(Optional) Name of a grouping column (e.g., same_country).}

\item{group_var2}{(Optional) Name of attention-level group column (e.g., accumulated_advantage_level).}

\item{N_ref}{Optional value for N to use in all starting points (default: NULL).}

\item{weight_early_points}{Logical. Whether to give more weight to early time points (default: FALSE).}
}
\value{
A list with:
\describe{
  \item{fitted}{A data frame with fitted values and predicted popularity.}
  \item{params}{A data frame of estimated parameters:
     \eqn{N}, \eqn{p}, \eqn{r}, \eqn{q}, AIC, BIC, RÂ², \eqn{t_c}, and its standard error.}
}
}
\description{
This function fits a biexponential forgetting curve to memory-related data,
optionally by group and/or attention level. It allows the user to specify a
reference value for \eqn{N} and tries a wide range of parameter initializations to
improve model convergence.
}
\details{
## Biexponential Decay Model:

The model estimated (on the log scale) is:
\deqn{
\log S(t) = \log \left[ N \left( e^{-(p+r)t} + \frac{r}{p + r - q} \left( e^{-qt} - e^{-(p+r)t} \right) \right) \right]
}

where:
\itemize{
  \item \eqn{S(t)}: attention/popularity at time \eqn{t}
  \item \eqn{N}: initial popularity level
  \item \eqn{p}: communicative decay rate
  \item \eqn{r}: communicative-to-cultural transfer rate
  \item \eqn{q}: cultural decay rate
}

## Why use the log-transformed model?

Working in the log scale provides several practical and statistical advantages:
\itemize{
  \item Stabilizes the variance across time, improving homoscedasticity.
  \item Enhances numerical stability during optimization.
  \item Prevents invalid predictions (e.g., negative popularity).
  \item Aligns with likelihood-based estimation for proportion/attention data.
}

## Critical Time:

The *critical time* \eqn{t_c} is the point at which communicative and cultural memory contributions are equal:
\deqn{
t_c = \frac{1}{p + r - q} \log \left( \frac{(p + r)(p - q)}{rq} \right)
}

The function also estimates the standard error of \eqn{t_c} using the delta method,
propagating uncertainty via the gradient and the parameter variance-covariance matrix.

## Input Requirements:

\itemize{
  \item `age_var`: numeric column indicating the age (e.g., time since event)
  \item `observed_col`: numeric column with observed popularity or attention values
  \item `group_var` (optional): grouping variable for stratified fitting
  \item `group_var2` (optional): secondary grouping variable (e.g., attention level)
  \item `accumulated_attention` (optional): used to estimate critical time error
}
}
\seealso{
\code{\link{plot_fitted_decay}}, \code{\link{fit_all_models_log}}
}
